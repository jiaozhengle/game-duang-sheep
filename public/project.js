require=function t(e,i,n){function o(a,s){if(!i[a]){if(!e[a]){var p="function"==typeof require&&require;if(!s&&p)return p(a,!0);if(r)return r(a,!0);var u=new Error("Cannot find module '"+a+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){var i=e[a][1][t];return o(i?i:t)},h,h.exports,t,e,i,n)}return i[a].exports}for(var r="function"==typeof require&&require,a=0;a<n.length;a++)o(n[a]);return o}({AudioControl:[function(t,e){Fire._RFpush(e,"d805blHUexOeYSA/4tyex0D","AudioControl");var i={};i.init=function(){this.hitAuido=Fire.Entity.find("/Audio/sfx_hit").getComponent(Fire.AudioSource),this.pointAuido=Fire.Entity.find("/Audio/sfx_point").getComponent(Fire.AudioSource),this.gameAuido=Fire.Entity.find("/Audio/Gameplay_Loop_03").getComponent(Fire.AudioSource),this.gameOverAuido=Fire.Entity.find("/Audio/GameOver").getComponent(Fire.AudioSource),this.jumpAuido=Fire.Entity.find("/Audio/Tag_Black").getComponent(Fire.AudioSource),this.readyAuido=Fire.Entity.find("/Audio/Start_Announce").getComponent(Fire.AudioSource)},i.playReadyGameBg=function(){this.readyAuido.play(),this.readyAuido.onEnd=function(){var e=t("Game");e.instance.gameState!==e.GameState.over&&(this.gameAuido.loop=!0,this.gameAuido.play())}.bind(this)},e.exports=i,Fire._RFpop()},{Game:"Game"}],Collision:[function(t,e){Fire._RFpush(e,"fef90zm9r1OOKvWTmCLwRPF","Collision");var i={collisionDetection:function(t,e){if(e&&e.length>0)for(var i=0,n=e.length;n>i;++i){var o,r,a,s,p,u=t.transform.y+t.sheepSpritRender.height/2,h=t.transform.y-t.sheepSpritRender.height/2,m=t.transform.x-t.sheepSpritRender.width/2,f=t.transform.x+t.sheepSpritRender.width/2,d=e[i],l=d.find("bottomPipe"),c=d.find("topPipe");if(l&&(o=l.getComponent(Fire.SpriteRenderer),r=l.transform.y+o.height/2,s=d.transform.x-(o.width/2-30),p=d.transform.x+(o.width/2-30),r>h&&(p>m&&f>p||f>s&&p>f)))return!0;if(c&&(o=c.getComponent(Fire.SpriteRenderer),a=c.transform.y-o.height/2,s=d.transform.x-(o.width/2-30),p=d.transform.x+(o.width/2-30),u>a&&(p>m&&f>p||f>s&&p>f)))return!0}return!1}};e.exports=i,Fire._RFpop()},{}],Effect:[function(t,e){Fire._RFpush(e,"729abaeVJZKAJM/docYGMh4","Effect");var i={toYPos:Fire.Vec2.zero,manually:!1,tempDisappear:null,manuallyEffect:null};i.init=function(){this.tempDisappear=Fire.Entity.find("/Prefabs/disappear")},i.create=function(t,e){var i=Fire.instantiate(t);i.transform.position=e;var n=i.getComponent(Fire.SpriteAnimation);n.play()},i.createManuallyEffectUpMove=function(t,e,i){this.manuallyEffect=Fire.instantiate(t),this.manuallyEffect.transform.position=e,this.manually=!0,this.toYPos=this.manuallyEffect.transform.position.y+i},i.onRefresh=function(){if(this.manually&&(this.manuallyEffect.transform.y+=200*Fire.Time.deltaTime,this.manuallyEffect.transform.y>this.toYPos)){var t=Fire.instantiate(this.tempDisappear),e=t.getComponent(Fire.SpriteAnimation);t.transform.position=this.manuallyEffect.transform.position,e.play(),this.manuallyEffect.destroy(),this.manually=!1,this.manuallyEffect=null,this.toYPos=0}},e.exports=i,Fire._RFpop()},{}],Floor:[function(t,e){Fire._RFpush(e,"b5c7aJTDwZCdI9cvuJShJKB","Floor");var i=Fire.extend(Fire.Component);i.prop("speed",300),i.prop("x",-858),i.prototype.onRefresh=function(t){this.entity.transform.x-=Fire.Time.deltaTime*(this.speed+t),this.entity.transform.x<this.x&&(this.entity.transform.x=0)},e.exports=i,Fire._RFpop()},{}],GameOverWindow:[function(t,e){Fire._RFpush(e,"3f0baj6BXpH2qXiN0dB8Ljf","GameOverWindow");var i=Fire.extend(Fire.Component);i.prop("title",null,Fire.ObjectType(Fire.Entity)),i.prop("panel",null,Fire.ObjectType(Fire.Entity)),i.prop("btn_play",null,Fire.ObjectType(Fire.Entity)),i.prop("score",null,Fire.ObjectType(Fire.Entity)),i.prototype.onRefresh=function(){var e=t("Game"),i=this.score.getComponent(Fire.BitmapText);i.text=e.instance.fraction,this.btn_play.on("mouseup",function(){i.text="0",this.entity.active=!1,e.instance.mask.active=!0}.bind(this)),this.title.transform.position=new Fire.Vec2(0,250),this.panel.transform.position=new Fire.Vec2(0,-200)},i.prototype.update=function(){this.title.transform.y>100?this.title.transform.y-=600*Fire.Time.deltaTime:this.title.transform.y=100,this.panel.transform.y<0?this.panel.transform.y+=600*Fire.Time.deltaTime:this.panel.transform.y=0},e.exports=i,Fire._RFpop()},{Game:"Game"}],Game:[function(t,e){Fire._RFpush(e,"fc9913XADNLgJ1ByKhqcC5Z","Game");var i=t("Sheep"),n=t("Floor"),o=t("Collision"),r=t("GameOverWindow"),a=t("AudioControl"),s=t("Effect"),p=function(t){return t[t.ready=0]="ready",t[t.run=1]="run",t[t.over=2]="over",t}({}),u=Fire.extend(Fire.Component,function(){u.instance=this});u.GameState=p,u.instance=null,u.prop("initSheepPos",new Fire.Vec2(-150,-180),Fire.ObjectType(Fire.Vec2)),u.prop("initPipeGroupPos",new Fire.Vec2(600,0),Fire.ObjectType(Fire.Vec2)),u.prop("createPipeTime",5),u.prop("gameSpeed",0),u.prototype.onLoad=function(){this.fogJumpEffect=Fire.Entity.find("/Prefabs/fog_1"),this.tempAddFractionEff=Fire.Entity.find("/Prefabs/addFraction"),this.tempMask=Fire.Entity.find("/Prefabs/mask"),this.pipeGroup=Fire.Entity.find("/Game/PipeGroup"),this.gameState=p.run,this.gameOverWindow=Fire.Entity.find("/GameOverWindow"),this.bg=Fire.Entity.find("/bg").getComponent(n),this.floor=Fire.Entity.find("/floor").getComponent(n),this.sheep=Fire.Entity.find("/sheep").getComponent(i),this.mask=Fire.Entity.find("/mask"),this.mask||(this.mask=Fire.instantiate(this.tempMask),this.mask.name="mask",this.mask.dontDestroyOnLoad=!0),this.maskRender=this.mask.getComponent(Fire.SpriteRenderer),Fire.Input.on("mousedown",function(){if(this.gameState!==p.over){var e=t("Sheep");this.sheep.anim.play(this.sheep.jumpAnimState,0),this.sheep.sheepState=e.SheepState.jump,this.sheep.tempSpeed=this.sheep.speed,a.jumpAuido.stop(),a.jumpAuido.play();var i=new Vec2(this.sheep.transform.x-80,this.sheep.transform.y+10);s.create(this.fogJumpEffect,i)}}.bind(this)),this.lastTime=10,this.pipeGroupList=[],this.entity.on("destroy-PipeGroup",function(t){if(this.pipeGroupList){var e=this.pipeGroupList.indexOf(t.target);this.pipeGroupList.splice(e,1)}}.bind(this)),this.fraction=0,this.fractionBtmpFont=Fire.Entity.find("/fraction").getComponent(Fire.BitmapText),a.init(),s.init()},u.prototype.onStart=function(){this.reset()},u.prototype.reset=function(){this.gameOverWindow.enabled=!1,this.fraction=0,this.fractionBtmpFont.text=this.fraction,this.lastTime=Fire.Time.time+10;for(var t=0,e=this.pipeGroupList.length;e>t;++t){var i=this.pipeGroupList[t];i&&void 0!==i&&i.destroy()}this.pipeGroupList=[],this.sheep.init(this.initSheepPos),this.gameState=p.ready,a.gameOverAuido.stop(),a.hitAuido.stop()},u.prototype.update=function(){switch(this.sheep.onRefresh(),this.gameState){case p.ready:this.mask.active&&(this.maskRender.color.a-=Fire.Time.deltaTime,this.maskRender.color.a<.3&&a.playReadyGameBg(),this.maskRender.color.a<=0&&(this.mask.active=!1,this.gameState=p.run));break;case p.run:var t=o.collisionDetection(this.sheep,this.pipeGroupList);if(t)return a.gameAuido.stop(),a.gameOverAuido.play(),a.hitAuido.play(),this.sheep.anim.play(this.sheep.dieAnimState,0),this.sheep.sheepState=i.SheepState.die,this.gameState=p.over,this.gameOverWindow.active=!0,void this.gameOverWindow.getComponent(r).onRefresh();var e=Math.abs(Fire.Time.time-this.lastTime);if(e>=this.createPipeTime&&(this.lastTime=Fire.Time.time,this.createPipeGroup()),this.bg.onRefresh(this.gameSpeed),this.floor.onRefresh(this.gameSpeed),this.pipeGroupList&&this.pipeGroupList.length>0){var n,u,h=0,m=this.pipeGroupList.length;for(h=0;m>h;++h)n=this.pipeGroupList[h],n&&void 0!==n&&(u=n.getComponent("PipeGroup"),u.onRefresh(this.gameSpeed));for(h=0;m>h;++h)if(n=this.pipeGroupList[h],n&&void 0!==n){u=n.getComponent("PipeGroup");var f=this.sheep.transform.x-this.sheep.sheepSpritRender.width/2,d=n.transform.x+u.pipeGroupWith/2;if(!u.hasPassed&&f>d){u.hasPassed=!0,this.fraction++,this.fractionBtmpFont.text=this.fraction;var l=new Vec2(this.sheep.transform.x-30,this.sheep.transform.y+50);s.createManuallyEffectUpMove(this.tempAddFractionEff,l,100),a.pointAuido.play()}}}break;case p.over:this.mask.active&&(this.maskRender.color.a+=Fire.Time.deltaTime,this.maskRender.color.a>1&&Fire.Engine.loadScene("MainMenu"))}s.onRefresh()},u.prototype.createPipeGroup=function(){var t=new Fire.Entity,e=t.addComponent("PipeGroup");t.parent=this.pipeGroup,t.transform.position=this.initPipeGroupPos,e.create(),this.pipeGroupList.push(t)},e.exports=u,Fire._RFpop()},{AudioControl:"AudioControl",Collision:"Collision",Effect:"Effect",Floor:"Floor",GameOverWindow:"GameOverWindow",Sheep:"Sheep"}],MainMenu:[function(t,e){Fire._RFpush(e,"3deb9n4Oe9OuJOziDW9qVVj","MainMenu");var i=Fire.extend(Fire.Component);i.prop("tempMask",null,Fire.ObjectType(Fire.Entity)),i.prototype.onLoad=function(){this.bg=this.entity.find("bg").getComponent("Floor"),this.floor=this.entity.find("floor").getComponent("Floor"),this.btn_play=this.entity.find("button_play"),this.btn_play.on("mouseup",function(){this.goToGame=!0,this.mask.active=!0}.bind(this)),this.mask=Fire.Entity.find("/mask"),this.maskRender=null,this.mask||(this.mask=Fire.instantiate(this.tempMask),this.mask.name="mask",this.mask.dontDestroyOnLoad=!0),this.maskRender=this.mask.getComponent(Fire.SpriteRenderer),this.maskRender.color.a=1,this.goToGame=!1},i.prototype.lateUpdate=function(){this.bg.onRefresh(0),this.floor.onRefresh(0),this.mask.active&&(this.goToGame?(this.maskRender.color.a+=Fire.Time.deltaTime,this.maskRender.color.a>1&&Fire.Engine.loadScene("Game")):(this.maskRender.color.a-=Fire.Time.deltaTime,this.maskRender.color.a<0&&(this.maskRender.color.a=0,this.mask.active=!1)))},e.exports=i,Fire._RFpop()},{}],PipeGroup:[function(t,e){Fire._RFpush(e,"004cc2gjpNJOJ2QWx8hv59q","PipeGroup");var i=Fire.extend(Fire.Component,function(){this.speed_=100,this.range_=-600,this.maxSpacing=250,this.minSpacing=222,this.lastPipeType=null,this.pipeGroupWith=0}),n=function(t){return t[t.Bottom=0]="bottom",t[t.Top=1]="top",t[t.Double=2]="double",t}({});i.prop("hasPassed",!1),i.prop("pipeType",n.Top,Fire.Enum(n)),i.prototype.TopPipePosRange=new Fire.Vec2(800,710),i.prototype.BottomPipePosRange=new Fire.Vec2(-750,-800),i.prototype.DoubleTopPipePosRange=new Fire.Vec2(1050,710),i.prototype.DoubleBottomPipePosRange=new Fire.Vec2(-800,-980),i.prototype.onLoad=function(){this.pipe=Fire.Entity.find("/Prefabs/pipe")},i.prototype.randomPipeType=function(){var t=Math.floor(100*Math.random())+1;return t>=1&&60>=t?n.Double:t>=60&&80>=t?n.Bottom:n.Top},i.prototype.create=function(){if(null!==this.lastPipeType&&this.lastPipeType===n.Top)for(;this.lastPipeType===this.pipeType;)this.pipeType=this.randomPipeType();else this.pipeType=this.randomPipeType();switch(this.entity.name=n[this.pipeType],this.pipeType){case n.Bottom:this.initBottomPipe();break;case n.Top:this.initTopPipe();break;case n.Double:this.initDoublePipe()}},i.prototype.initTopPipe=function(){var t=Fire.instantiate(this.pipe),e=t.getComponent(Fire.SpriteRenderer),i=Math.randomRange(this.TopPipePosRange.x,this.TopPipePosRange.y);t.parent=this.entity,t.transform.x=0,t.transform.y=i,t.transform.scaleY=1,t.name="topPipe",this.pipeGroupWith=e.width},i.prototype.initBottomPipe=function(){var t=Fire.instantiate(this.pipe),e=t.getComponent(Fire.SpriteRenderer),i=Math.randomRange(this.BottomPipePosRange.x,this.BottomPipePosRange.y);t.parent=this.entity,t.transform.x=0,t.transform.y=i,t.transform.scaleY=-1,t.name="bottomPipe",this.pipeGroupWith=e.sprite.width},i.prototype.initDoublePipe=function(){for(var t=Fire.instantiate(this.pipe),e=Fire.instantiate(this.pipe),i=t.getComponent(Fire.SpriteRenderer),n=t.getComponent(Fire.SpriteRenderer),o=0,r=0,a=0,s=0,p=0;p<this.minSpacing||p>this.maxSpacing;)o=Math.randomRange(this.DoubleTopPipePosRange.x,this.DoubleTopPipePosRange.y),r=Math.randomRange(this.DoubleBottomPipePosRange.x,this.DoubleBottomPipePosRange.y),a=o-i.sprite.height/2,s=r+n.sprite.height/2,p=0>a||s>0?Math.abs(a)-Math.abs(s):Math.abs(a)+Math.abs(s);t.parent=this.entity,t.transform.x=0,t.transform.y=o,t.transform.scaleY=1,t.name="topPipe",e.parent=this.entity,e.transform.x=0,e.transform.y=r,e.transform.scaleY=-1,e.name="bottomPipe",this.pipeGroupWith=n.sprite.width},i.prototype.onRefresh=function(t){this.entity.transform.x-=Fire.Time.deltaTime*(this.speed_+t),this.entity.transform.x<this.range_&&(this.entity.destroy(),this.entity.dispatchEvent(new Fire.Event("destroy-PipeGroup",!0)))},e.exports=i,Fire._RFpop()},{}],Sheep:[function(t,e){Fire._RFpush(e,"06633wKqTVM6a1K+G262q1Q","Sheep");var i=t("Effect"),n=function(t){return t[t.none=0]="none",t[t.run=0]="run",t[t.jump=1]="jump",t[t.drop=2]="drop",t[t.down=3]="down",t[t.die=4]="die",t}({}),o=Fire.extend(Fire.Component,function(){this.skyMaxY=250,this.anim=null,this.sheepSpritRender=0,this.runAnimState=null,this.jumpAnimState=null,this.dropAnimState=null,this.downAnimState=null,this.dieAnimState=null,this.sheepState=n.run,this.tempSpeed=0});o.SheepState=n,o.prop("gravity",9.8),o.prop("speed",300),o.prop("fLoorCoordinates",-180),o.prototype.onLoad=function(){this.anim=this.entity.getComponent(Fire.SpriteAnimation),this.runAnimState=this.anim.getAnimState("sheep_run"),this.jumpAnimState=this.anim.getAnimState("sheep_jump"),this.dropAnimState=this.anim.getAnimState("sheep_drop"),this.downAnimState=this.anim.getAnimState("sheep_down"),this.dieAnimState=this.anim.getAnimState("sheep_die"),this.sheepSpritRender=this.entity.getComponent(Fire.SpriteRenderer),this.dieRotation=-88,this.fogDownEffect=Fire.Entity.find("/Prefabs/fog_2")},o.prototype.init=function(t){this.entity.transform.rotation=0,this.entity.transform.position=t,this.anim.play(this.runAnimState,0),this.sheepState=n.run},o.prototype.onRefresh=function(){switch(this.sheepState!==n.run&&(this.tempSpeed-=100*Fire.Time.deltaTime*this.gravity),this.sheepState){case n.run:break;case n.jump:this.entity.transform.y+=Fire.Time.deltaTime*this.tempSpeed,this.tempSpeed<0&&(this.anim.play(this.dropAnimState,0),this.sheepState=n.drop);break;case n.drop:if(this.entity.transform.y+=Fire.Time.deltaTime*this.tempSpeed,this.entity.transform.y<=this.fLoorCoordinates){this.entity.transform.y=this.fLoorCoordinates;var t=new Vec2(this.entity.transform.x,this.entity.transform.y-30);i.create(this.fogDownEffect,t),this.anim.play(this.downAnimState,0),this.sheepState=n.down}break;case n.down:this.downAnimState&&!this.anim.isPlaying(this.downAnimState.name)&&(this.anim.play(this.runAnimState,0),this.sheepState=n.run);break;case n.die:if(this.entity.transform.y>this.fLoorCoordinates)this.entity.transform.y+=Fire.Time.deltaTime*this.tempSpeed;else{var t=new Vec2(this.entity.transform.x,this.entity.transform.y-30);i.create(this.fogDownEffect,t),this.sheepState=n.none}}},e.exports=o,Fire._RFpop()},{Effect:"Effect"}],"audio-clip":[function(t,e){Fire._RFpush(e,"audio-clip"),Fire.AudioClip=function(){var t=Fire.extend("Fire.AudioClip",Fire.Asset);return t.prop("rawData",null,Fire.RawType("audio"),Fire.HideInInspector),t.get("buffer",function(){return Fire.AudioContext.getClipBuffer(this)},Fire.HideInInspector),t.get("length",function(){return Fire.AudioContext.getClipLength(this)}),t.get("samples",function(){return Fire.AudioContext.getClipSamples(this)}),t.get("channels",function(){return Fire.AudioContext.getClipChannels(this)}),t.get("frequency",function(){return Fire.AudioContext.getClipFrequency(this)}),t}(),Fire.AudioClip.prototype.createEntity=function(t){var e=new Fire.Entity(this.name),i=e.addComponent(Fire.AudioSource);i.clip=this,t&&t(e)},e.exports=Fire.AudioClip,Fire._RFpop()},{}],"audio-legacy":[function(t,e){Fire._RFpush(e,"audio-legacy"),function(){function t(t,e){var i=document.createElement("audio");i.addEventListener("canplaythrough",function(){e(null,i)},!1),i.addEventListener("error",function(i){e('LoadAudioClip: "'+t+'" seems to be unreachable or the file is empty. InnerMessage: '+i+"\n This may caused by fireball-x/dev#267",null)},!1),i.src=t}var e=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(!e){var i={};Fire.LoadManager.registerRawTypes("audio",t),i.initSource=function(t){t._audio=null},i.getCurrentTime=function(t){return t&&t._audio&&t._playing?t._audio.currentTime:0},i.updateTime=function(t,e){if(t&&t._audio){{t._audio.duration}t._audio.currentTime=e}},i.updateMute=function(t){t&&t._audio&&(t._audio.muted=t.mute)},i.updateVolume=function(t){t&&t._audio&&(t._audio.volume=t.volume)},i.updateLoop=function(t){t&&t._audio&&(t._audio.loop=t.loop)},i.updateAudioClip=function(t){t&&t.clip&&(t._audio=t.clip.rawData)},i.pause=function(t){t._audio&&t._audio.pause()},i.stop=function(t){t._audio&&(t._audio.pause(),t._audio.currentTime=0)},i.play=function(t){t&&t.clip&&t.clip.rawData&&(!t._playing||t._paused)&&(this.updateAudioClip(t),this.updateVolume(t),this.updateLoop(t),this.updateMute(t),t._audio.play(),t._audio.addEventListener("ended",function(){t.onPlayEnd.bind(t)},!1))},i.getClipBuffer=function(){return Fire.error("Audio does not contain the <Buffer> attribute!"),null},i.getClipLength=function(t){return t.rawData.duration},i.getClipSamples=function(){return Fire.error("Audio does not contain the <Samples> attribute!"),null},i.getClipChannels=function(){return Fire.error("Audio does not contain the <Channels> attribute!"),null},i.getClipFrequency=function(){return Fire.error("Audio does not contain the <Frequency> attribute!"),null},Fire.AudioContext=i}}(),Fire._RFpop()},{}],"audio-source":[function(t,e){Fire._RFpush(e,"audio-source");var i=function(){var t=Fire.extend("Fire.AudioSource",Fire.Component,function(){this._playing=!1,this._paused=!1,this._startTime=0,this._lastPlay=0,this._buffSource=null,this._volumeGain=null,this.onEnd=null});return Fire.addComponentMenu(t,"AudioSource"),Object.defineProperty(t.prototype,"isPlaying",{get:function(){return this._playing&&!this._paused}}),Object.defineProperty(t.prototype,"isPaused",{get:function(){return this._paused}}),Object.defineProperty(t.prototype,"time",{get:function(){return Fire.AudioContext.getCurrentTime(this)},set:function(t){Fire.AudioContext.updateTime(this,t)}}),t.prop("_playbackRate",1,Fire.HideInInspector),t.getset("playbackRate",function(){return this._playbackRate},function(t){this._playbackRate!==t&&(this._playbackRate=t,Fire.AudioContext.updatePlaybackRate(this))}),t.prop("_clip",null,Fire.HideInInspector),t.getset("clip",function(){return this._clip},function(t){this._clip!==t&&(this._clip=t,Fire.AudioContext.updateAudioClip(this))},Fire.ObjectType(Fire.AudioClip)),t.prop("_loop",!1,Fire.HideInInspector),t.getset("loop",function(){return this._loop},function(t){this._loop!==t&&(this._loop=t,Fire.AudioContext.updateLoop(this))}),t.prop("_mute",!1,Fire.HideInInspector),t.getset("mute",function(){return this._mute},function(t){this._mute!==t&&(this._mute=t,Fire.AudioContext.updateMute(this))}),t.prop("_volume",1,Fire.HideInInspector),t.getset("volume",function(){return this._volume},function(t){this._volume!==t&&(this._volume=Math.clamp01(t),Fire.AudioContext.updateVolume(this))},Fire.Range(0,1)),t.prop("playOnAwake",!0),t.prototype.onPlayEnd=function(){this.onEnd&&this.onEnd(),this._playing=!1,this._paused=!1},t.prototype.pause=function(){this._paused||(Fire.AudioContext.pause(this),this._paused=!0)},t.prototype.play=function(){(!this._playing||this._paused)&&(this._paused?Fire.AudioContext.play(this,this._startTime):Fire.AudioContext.play(this,0),this._playing=!0,this._paused=!1)},t.prototype.stop=function(){this._playing&&(Fire.AudioContext.stop(this),this._playing=!1,this._paused=!1)},t.prototype.onLoad=function(){this._playing&&this.stop()},t.prototype.onStart=function(){},t.prototype.onEnable=function(){this.playOnAwake&&this.play()},t.prototype.onDisable=function(){this.stop()},t}();Fire.AudioSource=i,Fire._RFpop()},{}],"audio-web-audio":[function(t,e){Fire._RFpush(e,"audio-web-audio"),function(){function t(t,e,i,o){var r=!1,a=setTimeout(function(){o('The operation of decoding audio data already timeout! Audio url: "'+i+'". Set Fire.AudioContext.MaxDecodeTime to a larger value if this error often occur. See fireball-x/dev#318 for details.',null)},n.MaxDecodeTime);t.decodeAudioData(e,function(t){r||(o(null,t),clearTimeout(a))},function(t){r||(o(null,'LoadAudioClip: "'+i+'" seems to be unreachable or the file is empty. InnerMessage: '+t),clearTimeout(a))})}function e(e,i,n){var o=i&&function(n,o){o?t(Fire.nativeAC,o.response,e,i):i('LoadAudioClip: "'+e+'" seems to be unreachable or the file is empty. InnerMessage: '+n,null)};Fire.LoadManager._loadFromXHR(e,o,n,"arraybuffer")}var i=window.AudioContext||window.webkitAudioContext||window.mozAudioContext;if(i){Fire.nativeAC||(Fire.nativeAC=new i),Fire.LoadManager.registerRawTypes("audio",e);var n={};n.MaxDecodeTime=4e3,n.getCurrentTime=function(t){return t._paused?t._startTime:t._playing?t._startTime+this.getPlayedTime(t):0},n.getPlayedTime=function(t){return(Fire.nativeAC.currentTime-t._lastPlay)*t._playbackRate},n.updateTime=function(t,e){t._lastPlay=Fire.nativeAC.currentTime,t._startTime=e,t.isPlaying&&(this.pause(t),this.play(t))},n.updateMute=function(t){t._volumeGain&&(t._volumeGain.gain.value=t.mute?-1:t.volume-1)},n.updateVolume=function(t){t._volumeGain&&(t._volumeGain.gain.value=t.volume-1)},n.updateLoop=function(t){t._buffSource&&(t._buffSource.loop=t.loop)},n.updateAudioClip=function(t){t.isPlaying&&(this.stop(t,!1),this.play(t))},n.updatePlaybackRate=function(t){this.isPaused||(this.pause(t),this.play(t))},n.pause=function(t){t._buffSource&&(t._startTime+=this.getPlayedTime(t),t._buffSource.onended=null,t._buffSource.stop(0))},n.stop=function(t,e){t._buffSource&&(e||(t._buffSource.onended=null),t._buffSource.stop(0))},n.play=function(t,e){if(t.clip&&t.clip.rawData){var i=Fire.nativeAC.createBufferSource(),n=Fire.nativeAC.createGain();i.connect(n),n.connect(Fire.nativeAC.destination),i.connect(Fire.nativeAC.destination),i.buffer=t.clip.rawData,i.loop=t.loop,i.playbackRate.value=t.playbackRate,i.onended=t.onPlayEnd.bind(t),n.gain.value=t.mute?-1:t.volume-1,t._buffSource=i,t._volumeGain=n,t._startTime=e||0,t._lastPlay=Fire.nativeAC.currentTime,i.start(0,this.getCurrentTime(t))}},n.getClipBuffer=function(t){return t.rawData},n.getClipLength=function(t){return t.rawData?t.rawData.duration:-1},n.getClipSamples=function(t){return t.rawData?t.rawData.length:-1},n.getClipChannels=function(t){return t.rawData?t.rawData.numberOfChannels:-1},n.getClipFrequency=function(t){return t.rawData?t.rawData.sampleRate:-1},Fire.AudioContext=n}}(),Fire._RFpop()},{}],"sprite-animation-clip":[function(t,e){Fire._RFpush(e,"sprite-animation-clip");var i=Fire.extend("Fire.SpriteAnimationClip",Fire.CustomAsset,function(){this._frameInfoFrames=null});Fire.addCustomAssetMenu(i,"New Sprite Animation"),i.WrapMode=Fire.defineEnum({Default:-1,Once:-1,Loop:-1,PingPong:-1,ClampForever:-1}),i.StopAction=Fire.defineEnum({DoNothing:-1,DefaultSprite:1,Hide:-1,Destroy:-1});var n=Fire.define("FrameInfo").prop("sprite",null,Fire.ObjectType(Fire.Sprite)).prop("frames",0,Fire.Integer);i.prop("wrapMode",i.WrapMode.Default,Fire.Enum(i.WrapMode)),i.prop("stopAction",i.StopAction.DoNothing,Fire.Enum(i.StopAction)),i.prop("speed",1),i.prop("_frameRate",60,Fire.HideInInspector),i.getset("frameRate",function(){return this._frameRate},function(t){t!==this._frameRate&&(this._frameRate=Math.round(Math.max(t,1)))}),i.prop("frameInfos",[],Fire.ObjectType(n)),i.prototype.getTotalFrames=function(){for(var t=0,e=0;e<this.frameInfos.length;++e)t+=this.frameInfos[e].frames;return t},i.prototype.getFrameInfoFrames=function(){if(null===this._frameInfoFrames){this._frameInfoFrames=new Array(this.frameInfos.length);for(var t=0,e=0;e<this.frameInfos.length;++e)t+=this.frameInfos[e].frames,this._frameInfoFrames[e]=t}return this._frameInfoFrames},Fire.SpriteAnimationClip=i,e.exports=i,Fire._RFpop()},{}],"sprite-animation-state":[function(t,e){function i(t,e){for(var i=0,n=t.length-1;n>=i;){var o=i+n>>1;if(t[o]===e)return o;t[o]>e?n=o-1:i=o+1}return~i}function n(t,e,i){if(0===e)return 0;if(0>t&&(t=-t),i===o.WrapMode.Loop)return t%(e+1);if(i===o.WrapMode.PingPong){var n=Math.floor(t/e);if(t%=e,n%2===1)return e-t}else{if(0>t)return 0;if(t>e)return e}return t}Fire._RFpush(e,"sprite-animation-state");var o=t("sprite-animation-clip"),r=function(t){return t?(this.name=t.name,this.clip=t,this.wrapMode=t.wrapMode,this.stopAction=t.stopAction,this.speed=t.speed,this._frameInfoFrames=t.getFrameInfoFrames(),this.totalFrames=this._frameInfoFrames.length>0?this._frameInfoFrames[this._frameInfoFrames.length-1]:0,this.length=this.totalFrames/t.frameRate,this.frame=-1,this.time=0,void(this._cachedIndex=-1)):void Fire.error("Unspecified sprite animation clip")};r.prototype.getCurrentIndex=function(){if(this.totalFrames>1){this.frame=Math.floor(this.time*this.clip.frameRate),this.frame<0&&(this.frame=-this.frame);var t;if(this.wrapMode!==o.WrapMode.PingPong)t=n(this.frame,this.totalFrames-1,this.wrapMode);else{t=this.frame;var e=Math.floor(t/this.totalFrames);t%=this.totalFrames,1===(1&e)&&(t=this.totalFrames-1-t)}if(this._cachedIndex-1>=0&&t>=this._frameInfoFrames[this._cachedIndex-1]&&t<this._frameInfoFrames[this._cachedIndex])return this._cachedIndex;var r=i(this._frameInfoFrames,t+1);return 0>r&&(r=~r),this._cachedIndex=r,r}return 1===this.totalFrames?0:-1},Fire.SpriteAnimationState=r,e.exports=r,Fire._RFpop()},{"sprite-animation-clip":"sprite-animation-clip"}],"sprite-animation":[function(t,e){Fire._RFpush(e,"sprite-animation");var i=t("sprite-animation-clip"),n=t("sprite-animation-state"),o=Fire.extend("Fire.SpriteAnimation",Fire.Component,function(){this.animations=[],this._nameToState=null,this._curAnimation=null,this._spriteRenderer=null,this._defaultSprite=null,this._lastFrameIndex=-1,this._curIndex=-1,this._playStartFrame=0});Fire.addComponentMenu(o,"Sprite Animation"),o.prop("defaultAnimation",null,Fire.ObjectType(i)),o.prop("animations",[],Fire.ObjectType(i)),o.prop("_playAutomatically",!0,Fire.HideInInspector),o.getset("playAutomatically",function(){return this._playAutomatically},function(t){this._playAutomatically=t}),o.prototype.init=function(){var t=null!==this._nameToState;if(t===!1){this._spriteRenderer=this.entity.getComponent(Fire.SpriteRenderer),this._defaultSprite=this._spriteRenderer.sprite,this._nameToState={};for(var e=null,i=0;i<this.animations.length;++i){var o=this.animations[i];null!==o&&(e=new n(o),this._nameToState[e.name]=e)}this.getAnimState(this.defaultAnimation.name)||(e=new n(this.defaultAnimation),this._nameToState[e.name]=e)}},o.prototype.getAnimState=function(t){return this._nameToState&&this._nameToState[t]},o.prototype.isPlaying=function(t){var e=this.enabled&&this._curAnimation;return!(!e||t&&e.name!==t)},o.prototype.play=function(t,e){this._curAnimation="string"==typeof t?this.getAnimState(t):t||new n(this.defaultAnimation),null!==this._curAnimation&&(this._curIndex=-1,this._curAnimation.time=e||0,this._playStartFrame=Fire.Time.frameCount,this.sample())},o.prototype.onLoad=function(){if(this.init(),this.enabled&&this._playAutomatically&&this.defaultAnimation){var t=this.getAnimState(this.defaultAnimation.name);this.play(t,0)}},o.prototype.lateUpdate=function(){if(null!==this._curAnimation&&Fire.Time.frameCount>this._playStartFrame){var t=Fire.Time.deltaTime*this._curAnimation.speed;this.step(t)}},o.prototype.step=function(t){if(null!==this._curAnimation){this._curAnimation.time+=t,this.sample();var e=!1;(this._curAnimation.wrapMode===i.WrapMode.Once||this._curAnimation.wrapMode===i.WrapMode.Default||this._curAnimation.wrapMode===i.WrapMode.ClampForever)&&(this._curAnimation.speed>0&&this._curAnimation.frame>=this._curAnimation.totalFrames?this._curAnimation.wrapMode===i.WrapMode.ClampForever?(e=!1,this._curAnimation.frame=this._curAnimation.totalFrames,this._curAnimation.time=this._curAnimation.frame/this._curAnimation.clip.frameRate):(e=!0,this._curAnimation.frame=this._curAnimation.totalFrames):this._curAnimation.speed<0&&this._curAnimation.frame<0&&(this._curAnimation.wrapMode===i.WrapMode.ClampForever?(e=!1,this._curAnimation.time=0,this._curAnimation.frame=0):(e=!0,this._curAnimation.frame=0))),e&&this.stop(this._curAnimation)}else this._curIndex=-1},o.prototype.sample=function(){if(null!==this._curAnimation){var t=this._curAnimation.getCurrentIndex();t>=0&&t!=this._curIndex&&(this._spriteRenderer.sprite=this._curAnimation.clip.frameInfos[t].sprite),this._curIndex=t}else this._curIndex=-1},o.prototype.stop=function(t){if(null!==t){t===this._curAnimation&&(this._curAnimation=null),t.time=0;var e=t.stopAction;switch(e){case i.StopAction.DoNothing:break;case i.StopAction.DefaultSprite:this._spriteRenderer.sprite=this._defaultSprite;break;case i.StopAction.Hide:this._spriteRenderer.enabled=!1;break;case i.StopAction.Destroy:this.entity.destroy()}this._curAnimation=null}},Fire.SpriteAnimation=o,e.exports=o,Fire._RFpop()},{"sprite-animation-clip":"sprite-animation-clip","sprite-animation-state":"sprite-animation-state"}]},{},["audio-clip","audio-legacy","audio-source","audio-web-audio","sprite-animation-clip","sprite-animation-state","sprite-animation","AudioControl","Collision","Effect","Floor","Game","GameOverWindow","MainMenu","PipeGroup","Sheep"]);
//# sourceMappingURL=project.js.map