{"version":3,"sources":["project.js"],"names":["require","e","t","n","r","s","o","u","a","i","f","Error","code","l","exports","call","length","AudioControl","module","Fire","_RFpush","init","this","hitAuido","Entity","find","getComponent","AudioSource","pointAuido","gameAuido","gameOverAuido","jumpAuido","readyAuido","playReadyGameBg","play","onEnd","Game","instance","gameState","GameState","over","loop","bind","_RFpop","Collision","collisionDetection","sheep","pipeGroupList","len","pipeRender","pipeTop","pipeBottom","pipeLeft","pipeRight","sheepTop","transform","y","sheepSpritRender","height","sheepBottom","sheepLeft","x","width","sheepRight","pipeGroupEntity","bottomPipe","topPipe","SpriteRenderer","Effect","toYPos","Vec2","zero","manually","tempDisappear","manuallyEffect","create","tempEntity","pos","effect","instantiate","position","effectAnim","SpriteAnimation","createManuallyEffectUpMove","toUpPos","onRefresh","Time","deltaTime","disappear","disappearAnim","destroy","Floor","extend","Component","prop","prototype","gameSpeed","entity","speed","GameOverWindow","ObjectType","scoreValue","score","BitmapText","text","fraction","btn_play","on","active","mask","title","panel","update","Sheep","ready","run","onLoad","fogJumpEffect","tempAddFractionEff","tempMask","pipeGroup","gameOverWindow","bg","floor","name","dontDestroyOnLoad","maskRender","Input","anim","jumpAnimState","sheepState","SheepState","jump","tempSpeed","stop","lastTime","event","index","indexOf","target","splice","fractionBtmpFont","onStart","reset","enabled","time","undefined","initSheepPos","color","gameOver","dieAnimState","die","curTime","Math","abs","createPipeTime","createPipeGroup","pipeGropComp","sheepX","pipeGroupX","pipeGroupWith","hasPassed","initPos","Engine","loadScene","addComponent","parent","initPipeGroupPos","push","MainMenu","goToGame","lateUpdate","PipeGroup","speed_","range_","maxSpacing","minSpacing","lastPipeType","PipeType","Bottom","Top","Double","Enum","TopPipePosRange","BottomPipePosRange","DoubleTopPipePosRange","DoubleBottomPipePosRange","pipe","randomPipeType","randomVlue","random","pipeType","initBottomPipe","initTopPipe","initDoublePipe","topPipeRender","randomY","randomRange","scaleY","bottomPipeRender","sprite","randomTopY","randomBottomY","topY","bottomY","spacing","dispatchEvent","Event","none","drop","down","skyMaxY","runAnimState","dropAnimState","downAnimState","getAnimState","dieRotation","fogDownEffect","rotation","gravity","fLoorCoordinates","isPlaying","audio-clip","AudioClip","Asset","RawType","HideInInspector","get","AudioContext","getClipBuffer","getClipLength","getClipSamples","getClipChannels","getClipFrequency","createEntity","cb","ent","audioSource","clip","audio-legacy","loader","url","callback","audio","document","createElement","addEventListener","src","UseWebAudio","window","webkitAudioContext","mozAudioContext","LoadManager","registerRawTypes","initSource","_audio","getCurrentTime","_playing","currentTime","updateTime","value","duration","updateMute","muted","mute","updateVolume","volume","updateLoop","updateAudioClip","rawData","pause","_paused","onPlayEnd","error","audio-source","_startTime","_lastPlay","_buffSource","_volumeGain","addComponentMenu","Object","defineProperty","set","getset","_playbackRate","updatePlaybackRate","_clip","_loop","_mute","_volume","clamp01","Range","onEnable","playOnAwake","onDisable","audio-web-audio","safeDecodeAudioData","context","buffer","timeout","timerId","setTimeout","MaxDecodeTime","decodeAudioData","decodedData","clearTimeout","onProgress","xhr","nativeAC","response","_loadFromXHR","NativeAudioContext","getPlayedTime","gain","isPaused","onended","ended","at","bufferSource","createBufferSource","createGain","connect","destination","playbackRate","start","numberOfChannels","sampleRate","sprite-animation-clip","SpriteAnimationClip","CustomAsset","_frameInfoFrames","addCustomAssetMenu","WrapMode","defineEnum","Default","Once","Loop","PingPong","ClampForever","StopAction","DoNothing","DefaultSprite","Hide","Destroy","FrameInfo","define","Sprite","Integer","_frameRate","round","max","getTotalFrames","frames","frameInfos","getFrameInfoFrames","Array","totalFrames","sprite-animation-state","_binarySearch","array","h","m","_wrap","_value","_maxValue","_wrapMode","cnt","SpriteAnimationState","animClip","wrapMode","stopAction","frameRate","frame","_cachedIndex","getCurrentIndex","wrappedIndex","frameInfoIndex","sprite-animation","animations","_nameToState","_curAnimation","_spriteRenderer","_defaultSprite","_lastFrameIndex","_curIndex","_playStartFrame","_playAutomatically","initialized","state","defaultAnimation","playingAnim","animState","frameCount","sample","delta","step","newIndex"],"mappings":"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","file":"project.js","sourcesContent":["require=(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require==\"function\"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error(\"Cannot find module '\"+o+\"'\");throw f.code=\"MODULE_NOT_FOUND\",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require==\"function\"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({\"AudioControl\":[function(require,module,exports){\nFire._RFpush(module, 'd805blHUexOeYSA/4tyex0D', 'AudioControl');\n// script/AudioControl.js\n\n// AudioControl\nvar AudioControl = {};\n\nAudioControl.init = function () {\n    //-- 音效 （撞到）（得分）(失败)\n    this.hitAuido = Fire.Entity.find('/Audio/sfx_hit').getComponent(Fire.AudioSource);\n    this.pointAuido = Fire.Entity.find('/Audio/sfx_point').getComponent(Fire.AudioSource);\n    this.gameAuido = Fire.Entity.find('/Audio/Gameplay_Loop_03').getComponent(Fire.AudioSource);\n    this.gameOverAuido = Fire.Entity.find('/Audio/GameOver').getComponent(Fire.AudioSource);\n    this.jumpAuido = Fire.Entity.find('/Audio/Tag_Black').getComponent(Fire.AudioSource);\n    this.readyAuido = Fire.Entity.find('/Audio/Start_Announce').getComponent(Fire.AudioSource);\n};\n\nAudioControl.playReadyGameBg = function () {\n    this.readyAuido.play();\n    this.readyAuido.onEnd = function () {\n        var Game = require('Game');\n        if(Game.instance.gameState === Game.GameState.over){\n            return;\n        }\n        this.gameAuido.loop = true;\n        this.gameAuido.play();\n    }.bind(this);\n};\n\nmodule.exports = AudioControl;\n\nFire._RFpop();\n},{\"Game\":\"Game\"}],\"Collision\":[function(require,module,exports){\nFire._RFpush(module, 'fef90zm9r1OOKvWTmCLwRPF', 'Collision');\n// script/Collision.js\n\nvar Collision = {\n    //-- 检测碰撞\n    collisionDetection: function (sheep, pipeGroupList) {\n        if (pipeGroupList && pipeGroupList.length > 0) {\n            for (var i = 0, len = pipeGroupList.length; i < len; ++i) {\n\n                //-- 绵羊的四个面的坐标\n                var sheepTop = (sheep.transform.y + sheep.sheepSpritRender.height / 2 );\n                var sheepBottom = (sheep.transform.y - sheep.sheepSpritRender.height / 2 );\n                var sheepLeft = (sheep.transform.x - sheep.sheepSpritRender.width / 2 );\n                var sheepRight = (sheep.transform.x + sheep.sheepSpritRender.width / 2 );\n\n                var pipeGroupEntity = pipeGroupList[i];\n                var bottomPipe = pipeGroupEntity.find('bottomPipe');\n                var topPipe = pipeGroupEntity.find('topPipe');\n\n                var pipeRender, pipeTop, pipeBottom, pipeLeft, pipeRight;\n                if (bottomPipe) {\n                    pipeRender = bottomPipe.getComponent(Fire.SpriteRenderer);\n                    pipeTop = bottomPipe.transform.y + (pipeRender.height / 2);\n                    pipeLeft = pipeGroupEntity.transform.x - (pipeRender.width / 2 - 30);\n                    pipeRight = pipeGroupEntity.transform.x + (pipeRender.width / 2 - 30);\n                    if (sheepBottom < pipeTop && ((sheepLeft < pipeRight && sheepRight > pipeRight) || (sheepRight > pipeLeft && sheepRight < pipeRight))) {\n                        return true;\n                    }\n                }\n                if (topPipe) {\n                    pipeRender = topPipe.getComponent(Fire.SpriteRenderer);\n                    pipeBottom = topPipe.transform.y - (pipeRender.height / 2);\n                    pipeLeft = pipeGroupEntity.transform.x - (pipeRender.width / 2 - 30);\n                    pipeRight = pipeGroupEntity.transform.x + (pipeRender.width / 2 - 30);\n                    if (sheepTop > pipeBottom && ((sheepLeft < pipeRight && sheepRight > pipeRight) || (sheepRight > pipeLeft && sheepRight < pipeRight))) {\n                        return true;\n                    }\n                }\n            }\n        }\n        return false;\n    }\n}\n\nmodule.exports = Collision;\n\nFire._RFpop();\n},{}],\"Effect\":[function(require,module,exports){\nFire._RFpush(module, '729abaeVJZKAJM/docYGMh4', 'Effect');\n// script/Effect.js\n\n// Effect\nvar Effect = {\n    toYPos        : Fire.Vec2.zero,\n    manually      : false,\n    tempDisappear : null,\n    manuallyEffect: null\n};\n\nEffect.init = function () {\n    this.tempDisappear = Fire.Entity.find('/Prefabs/disappear');\n};\n\nEffect.create = function (tempEntity, pos) {\n    var effect = Fire.instantiate(tempEntity);\n    effect.transform.position = pos;\n    var effectAnim = effect.getComponent(Fire.SpriteAnimation);\n    effectAnim.play();\n};\n\nEffect.createManuallyEffectUpMove = function (tempEntity, pos, toUpPos) {\n    this.manuallyEffect = Fire.instantiate(tempEntity);\n    this.manuallyEffect.transform.position = pos;\n    this.manually = true;\n    this.toYPos = this.manuallyEffect.transform.position.y + toUpPos;\n};\n\nEffect.onRefresh = function () {\n    if (this.manually) {\n        this.manuallyEffect.transform.y += Fire.Time.deltaTime * 200;\n        if (this.manuallyEffect.transform.y > this.toYPos) {\n            var disappear = Fire.instantiate(this.tempDisappear);\n            var disappearAnim = disappear.getComponent(Fire.SpriteAnimation);\n            disappear.transform.position = this.manuallyEffect.transform.position;\n            disappearAnim.play();\n\n            this.manuallyEffect.destroy();\n            this.manually = false;\n            this.manuallyEffect = null;\n            this.toYPos = 0;\n        }\n    }\n};\n\nmodule.exports = Effect;\n\nFire._RFpop();\n},{}],\"Floor\":[function(require,module,exports){\nFire._RFpush(module, 'b5c7aJTDwZCdI9cvuJShJKB', 'Floor');\n// script/Floor.js\n\nvar Floor = Fire.extend(Fire.Component);\n//speed\nFloor.prop('speed', 300);\n\nFloor.prop('x', -858);\n\nFloor.prototype.onRefresh = function (gameSpeed) {\n    this.entity.transform.x -= (Fire.Time.deltaTime * ( this.speed + gameSpeed ));\n    if (this.entity.transform.x < this.x) {\n        this.entity.transform.x = 0;\n    }\n};\n\nmodule.exports = Floor;\n\nFire._RFpop();\n},{}],\"GameOverWindow\":[function(require,module,exports){\nFire._RFpush(module, '3f0baj6BXpH2qXiN0dB8Ljf', 'GameOverWindow');\n// script/GameOverWindow.js\n\nvar GameOverWindow = Fire.extend(Fire.Component);\n\nGameOverWindow.prop('title', null, Fire.ObjectType(Fire.Entity));\n\nGameOverWindow.prop('panel', null, Fire.ObjectType(Fire.Entity));\n\nGameOverWindow.prop('btn_play', null, Fire.ObjectType(Fire.Entity));\n\nGameOverWindow.prop('score', null, Fire.ObjectType(Fire.Entity));\n\nGameOverWindow.prototype.onRefresh = function () {\n    var Game = require('Game');\n    var scoreValue = this.score.getComponent(Fire.BitmapText);\n    scoreValue.text = Game.instance.fraction;\n    this.btn_play.on('mouseup', function () {\n        scoreValue.text = \"0\";\n        this.entity.active = false;\n        Game.instance.mask.active = true;\n    }.bind(this));\n    this.title.transform.position = new Fire.Vec2(0, 250);\n    this.panel.transform.position = new Fire.Vec2(0, -200);\n};\n\nGameOverWindow.prototype.update = function () {\n    if (this.title.transform.y > 100) {\n        this.title.transform.y -= Fire.Time.deltaTime * 600;\n    }\n    else {\n        this.title.transform.y = 100;\n    }\n    if (this.panel.transform.y < 0) {\n        this.panel.transform.y += Fire.Time.deltaTime * 600;\n    }\n    else {\n        this.panel.transform.y = 0;\n    }\n};\n\nmodule.exports = GameOverWindow;\n\nFire._RFpop();\n},{\"Game\":\"Game\"}],\"Game\":[function(require,module,exports){\nFire._RFpush(module, 'fc9913XADNLgJ1ByKhqcC5Z', 'Game');\n// script/Game.js\n\nvar Sheep = require('Sheep');\nvar Floor = require('Floor');\nvar Collision = require('Collision');\nvar GameOverWindow = require('GameOverWindow');\nvar AudioControl = require('AudioControl');\nvar Effect = require('Effect');\n\nvar GameState = (function (t) {\n    t[t.ready = 0] = 'ready';\n    t[t.run = 1] = 'run';\n    t[t.over = 2] = 'over';\n    return t;\n})({});\n\nvar Game = Fire.extend(Fire.Component, function () {\n    Game.instance = this;\n});\n\nGame.GameState = GameState;\n\nGame.instance = null;\n\n//-- 绵羊初始X坐标\nGame.prop('initSheepPos', new Fire.Vec2(-150, -180), Fire.ObjectType(Fire.Vec2));\n\n//-- 创建时管道初始X坐标\nGame.prop('initPipeGroupPos', new Fire.Vec2(600, 0), Fire.ObjectType(Fire.Vec2));\n\nGame.prop('createPipeTime', 5);\n\nGame.prop('gameSpeed', 0);\n\nGame.prototype.onLoad = function () {\n\n    this.fogJumpEffect = Fire.Entity.find('/Prefabs/fog_1');\n    this.tempAddFractionEff = Fire.Entity.find('/Prefabs/addFraction');\n    this.tempMask = Fire.Entity.find('/Prefabs/mask');\n\n    this.pipeGroup = Fire.Entity.find('/Game/PipeGroup');\n\n    //-- 游戏状态\n    this.gameState = GameState.run;\n\n    this.gameOverWindow = Fire.Entity.find('/GameOverWindow');\n\n    this.bg = Fire.Entity.find('/bg').getComponent(Floor);\n    this.floor = Fire.Entity.find('/floor').getComponent(Floor);\n    this.sheep = Fire.Entity.find('/sheep').getComponent(Sheep);\n\n    this.mask = Fire.Entity.find('/mask');\n    if (!this.mask) {\n        this.mask = Fire.instantiate(this.tempMask);\n        this.mask.name = 'mask';\n        this.mask.dontDestroyOnLoad = true;\n    }\n    this.maskRender = this.mask.getComponent(Fire.SpriteRenderer);\n\n\n    Fire.Input.on('mousedown', function (event) {\n        if (this.gameState === GameState.over) {\n            return;\n        }\n        var Sheep = require('Sheep');\n        this.sheep.anim.play(this.sheep.jumpAnimState, 0);\n        this.sheep.sheepState = Sheep.SheepState.jump;\n        this.sheep.tempSpeed = this.sheep.speed;\n        AudioControl.jumpAuido.stop();\n        AudioControl.jumpAuido.play();\n\n        var pos = new Vec2(this.sheep.transform.x - 80, this.sheep.transform.y + 10);\n        Effect.create(this.fogJumpEffect, pos);\n    }.bind(this));\n\n    this.lastTime = 10;\n    this.pipeGroupList = [];\n    this.entity.on(\"destroy-PipeGroup\", function (event) {\n        if (this.pipeGroupList) {\n            var index = this.pipeGroupList.indexOf(event.target);\n            this.pipeGroupList.splice(index, 1);\n        }\n    }.bind(this));\n\n    //-- 分数\n    this.fraction = 0;\n    this.fractionBtmpFont = Fire.Entity.find('/fraction').getComponent(Fire.BitmapText);\n\n    //-- 音效\n    AudioControl.init();\n\n    //-- 特效\n    Effect.init();\n};\n\nGame.prototype.onStart = function () {\n    this.reset();\n};\n\nGame.prototype.reset = function () {\n    this.gameOverWindow.enabled = false;\n    this.fraction = 0;\n    this.fractionBtmpFont.text = this.fraction;\n    this.lastTime = Fire.Time.time + 10;\n    for (var i = 0, len = this.pipeGroupList.length; i < len; ++i) {\n        var pipeGroupEntity = this.pipeGroupList[i];\n        if (!pipeGroupEntity || pipeGroupEntity === undefined) {\n            continue;\n        }\n        pipeGroupEntity.destroy();\n    }\n    this.pipeGroupList = [];\n    this.sheep.init(this.initSheepPos);\n    this.gameState = GameState.ready;\n    AudioControl.gameOverAuido.stop();\n    AudioControl.hitAuido.stop();\n};\n\nGame.prototype.update = function () {\n\n    //-- 绵羊的更新\n    //-- 绵羊的更新\n    this.sheep.onRefresh();\n\n    switch (this.gameState) {\n        case GameState.ready:\n            if (this.mask.active) {\n                this.maskRender.color.a -= Fire.Time.deltaTime;\n                if (this.maskRender.color.a < 0.3) {\n                    AudioControl.playReadyGameBg();\n                }\n                if (this.maskRender.color.a <= 0) {\n                    this.mask.active = false;\n                    this.gameState = GameState.run;\n                }\n            }\n            break;\n        case GameState.run:\n            var gameOver = Collision.collisionDetection(this.sheep, this.pipeGroupList);\n            if (gameOver) {\n                AudioControl.gameAuido.stop();\n                AudioControl.gameOverAuido.play();\n                AudioControl.hitAuido.play();\n                this.sheep.anim.play(this.sheep.dieAnimState, 0);\n                this.sheep.sheepState = Sheep.SheepState.die;\n                this.gameState = GameState.over;\n                this.gameOverWindow.active = true;\n                this.gameOverWindow.getComponent(GameOverWindow).onRefresh();\n                return;\n            }\n            //-- 每过一段时间创建管道\n            var curTime = Math.abs(Fire.Time.time - this.lastTime);\n            if (curTime >= this.createPipeTime) {\n                this.lastTime = Fire.Time.time;\n                this.createPipeGroup();\n            }\n            //-- 背景刷新\n            this.bg.onRefresh(this.gameSpeed);\n            //-- 地板刷新\n            this.floor.onRefresh(this.gameSpeed);\n            //-- 管道刷新\n            if (this.pipeGroupList && this.pipeGroupList.length > 0) {\n                var i = 0, len = this.pipeGroupList.length;\n                var pipeGroupEntity, pipeGropComp;\n                //-- 管道刷新\n                for (i = 0; i < len; ++i) {\n                    pipeGroupEntity = this.pipeGroupList[i];\n                    if (!pipeGroupEntity || pipeGroupEntity === undefined) {\n                        continue;\n                    }\n                    pipeGropComp = pipeGroupEntity.getComponent('PipeGroup');\n                    pipeGropComp.onRefresh(this.gameSpeed);\n                }\n                //-- 绵羊通过管道的计算 && 计算分数\n                for (i = 0; i < len; ++i) {\n                    pipeGroupEntity = this.pipeGroupList[i];\n                    if (!pipeGroupEntity || pipeGroupEntity === undefined) {\n                        continue;\n                    }\n                    pipeGropComp = pipeGroupEntity.getComponent('PipeGroup');\n                    var sheepX = (this.sheep.transform.x - this.sheep.sheepSpritRender.width / 2 );\n                    var pipeGroupX = (pipeGroupEntity.transform.x + pipeGropComp.pipeGroupWith / 2 );\n                    if (!pipeGropComp.hasPassed && sheepX > pipeGroupX) {\n                        pipeGropComp.hasPassed = true;\n                        this.fraction++;\n                        this.fractionBtmpFont.text = this.fraction;\n                        var initPos = new Vec2(this.sheep.transform.x - 30, this.sheep.transform.y + 50);\n                        Effect.createManuallyEffectUpMove(this.tempAddFractionEff, initPos, 100);\n                        AudioControl.pointAuido.play();\n                    }\n                }\n            }\n            break;\n        case GameState.over:\n            if (this.mask.active) {\n                this.maskRender.color.a += Fire.Time.deltaTime;\n                if (this.maskRender.color.a > 1) {\n                    Fire.Engine.loadScene('MainMenu');\n                }\n            }\n            break;\n        default :\n            break;\n    }\n\n    //-- 特效刷新\n    Effect.onRefresh();\n};\n\n//-- 创建管道组\nGame.prototype.createPipeGroup = function () {\n    var entity = new Fire.Entity();\n    var pipeGropComp = entity.addComponent('PipeGroup')\n    entity.parent = this.pipeGroup;\n    entity.transform.position = this.initPipeGroupPos;\n    pipeGropComp.create();\n    this.pipeGroupList.push(entity);\n};\n\nmodule.exports = Game;\n\nFire._RFpop();\n},{\"AudioControl\":\"AudioControl\",\"Collision\":\"Collision\",\"Effect\":\"Effect\",\"Floor\":\"Floor\",\"GameOverWindow\":\"GameOverWindow\",\"Sheep\":\"Sheep\"}],\"MainMenu\":[function(require,module,exports){\nFire._RFpush(module, '3deb9n4Oe9OuJOziDW9qVVj', 'MainMenu');\n// script/MainMenu.js\n\nvar MainMenu = Fire.extend(Fire.Component);\n\nMainMenu.prop('tempMask', null, Fire.ObjectType(Fire.Entity));\n\nMainMenu.prototype.onLoad = function () {\n    this.bg = this.entity.find('bg').getComponent('Floor');\n    this.floor = this.entity.find('floor').getComponent('Floor');\n    this.btn_play = this.entity.find('button_play');\n    this.btn_play.on('mouseup', function () {\n        this.goToGame = true;\n        this.mask.active = true;\n    }.bind(this));\n\n    this.mask = Fire.Entity.find('/mask');\n    this.maskRender = null;\n    if(!this.mask){\n        this.mask = Fire.instantiate(this.tempMask);\n        this.mask.name = 'mask';\n        this.mask.dontDestroyOnLoad = true;\n    }\n    this.maskRender = this.mask.getComponent(Fire.SpriteRenderer);\n    this.maskRender.color.a = 1;\n    this.goToGame = false;\n};\n\nMainMenu.prototype.lateUpdate = function () {\n    //-- 背景更新\n    this.bg.onRefresh(0);\n    //-- 地面更新\n    this.floor.onRefresh(0);\n\n    if (this.mask.active) {\n        if (this.goToGame) {\n            this.maskRender.color.a += Fire.Time.deltaTime;\n            if (this.maskRender.color.a > 1) {\n                Fire.Engine.loadScene('Game');\n            }\n        }\n        else {\n            this.maskRender.color.a -= Fire.Time.deltaTime;\n            if (this.maskRender.color.a < 0) {\n                this.maskRender.color.a = 0;\n                this.mask.active = false;\n            }\n        }\n    }\n};\n\nmodule.exports = MainMenu;\n\nFire._RFpop();\n},{}],\"PipeGroup\":[function(require,module,exports){\nFire._RFpush(module, '004cc2gjpNJOJ2QWx8hv59q', 'PipeGroup');\n// script/PipeGroup.js\n\nvar PipeGroup = Fire.extend(Fire.Component, function () {\n    //-- 基础移动速度\n    this.speed_ = 100;\n    //-- ( Beyond this range will be destroyed ) 超出这个范围就会被销毁\n    this.range_ = -600;\n    //-- 最大间距\n    this.maxSpacing = 250;//280;\n    //-- 最小间距\n    this.minSpacing = 222; //250;\n    //-- 上一次随机到的管道类型\n    this.lastPipeType = null;\n    //-- 管道的宽度\n    this.pipeGroupWith = 0;\n});\n\n//-- 管道的类型\nvar PipeType = (function (t) {\n    t[t.Bottom = 0] = 'bottom';        // 上方管子\n    t[t.Top = 1] = 'top';           // 上方管子\n    t[t.Double = 2] = 'double';        // 下上方管子\n    return t;\n})({});\n\nPipeGroup.prop('hasPassed', false);\n\n//-- 管道类型\nPipeGroup.prop('pipeType', PipeType.Top, Fire.Enum(PipeType));\n\n//-- 上方管子坐标范围 Max 与 Min\nPipeGroup.prototype.TopPipePosRange = new Fire.Vec2(800, 710);\n\n//-- 下方管子坐标范围 Max 与 Min\nPipeGroup.prototype.BottomPipePosRange = new Fire.Vec2(-750, -800);\n\n//-- 双个上方管子坐标范围 Max 与 Min\nPipeGroup.prototype.DoubleTopPipePosRange = new Fire.Vec2(1050, 710);\n\n//-- 双个下方管子坐标范围 Max 与 Min\nPipeGroup.prototype.DoubleBottomPipePosRange = new Fire.Vec2(-800, -980);\n\nPipeGroup.prototype.onLoad = function () {\n    this.pipe = Fire.Entity.find('/Prefabs/pipe');\n};\n\nPipeGroup.prototype.randomPipeType = function () {\n    var randomVlue = Math.floor(Math.random() * 100) + 1;\n    if (randomVlue >= 1 && randomVlue <= 60) {\n        return PipeType.Double;\n    }\n    else if (randomVlue >= 60 && randomVlue <= 80) {\n        return PipeType.Bottom;\n    }\n    else {\n        return PipeType.Top;\n    }\n}\n\nPipeGroup.prototype.create = function () {\n    if (this.lastPipeType !== null && this.lastPipeType === PipeType.Top) {\n        while (this.lastPipeType === this.pipeType) {\n            this.pipeType = this.randomPipeType();\n        }\n    }\n    else {\n        this.pipeType = this.randomPipeType();\n        //-- 为了体验，防止第一次出现的管道是上方的\n    }\n    this.entity.name = PipeType[this.pipeType];\n    switch (this.pipeType) {\n        case PipeType.Bottom:\n            this.initBottomPipe();\n            break;\n        case PipeType.Top:\n            this.initTopPipe();\n            break;\n        case PipeType.Double:\n            this.initDoublePipe();\n            break;\n        default:\n            break;\n    }\n};\n\nPipeGroup.prototype.initTopPipe = function () {\n    var topPipe = Fire.instantiate(this.pipe);\n    var topPipeRender = topPipe.getComponent(Fire.SpriteRenderer);\n    var randomY = Math.randomRange(this.TopPipePosRange.x, this.TopPipePosRange.y);\n\n    topPipe.parent = this.entity;\n    topPipe.transform.x = 0;\n    topPipe.transform.y = randomY;\n    topPipe.transform.scaleY = 1;\n    topPipe.name = 'topPipe';\n\n    this.pipeGroupWith = topPipeRender.width;\n};\n\nPipeGroup.prototype.initBottomPipe = function () {\n    var bottomPipe = Fire.instantiate(this.pipe);\n    var bottomPipeRender = bottomPipe.getComponent(Fire.SpriteRenderer);\n    var randomY = Math.randomRange(this.BottomPipePosRange.x, this.BottomPipePosRange.y);\n\n    bottomPipe.parent = this.entity;\n    bottomPipe.transform.x = 0;\n    bottomPipe.transform.y = randomY;\n    bottomPipe.transform.scaleY = -1;\n    bottomPipe.name = 'bottomPipe';\n\n    this.pipeGroupWith = bottomPipeRender.sprite.width;\n};\n\nPipeGroup.prototype.initDoublePipe = function () {\n    var topPipe = Fire.instantiate(this.pipe);\n    var bottomPipe = Fire.instantiate(this.pipe);\n    var topPipeRender = topPipe.getComponent(Fire.SpriteRenderer);\n    var bottomPipeRender = topPipe.getComponent(Fire.SpriteRenderer);\n\n    var randomTopY = 0;\n    var randomBottomY = 0;\n    var topY = 0;\n    var bottomY = 0;\n    var spacing = 0;\n\n    while (spacing < this.minSpacing || spacing > this.maxSpacing) {\n        randomTopY = Math.randomRange(this.DoubleTopPipePosRange.x, this.DoubleTopPipePosRange.y);\n        randomBottomY = Math.randomRange(this.DoubleBottomPipePosRange.x, this.DoubleBottomPipePosRange.y);\n        topY = randomTopY - (topPipeRender.sprite.height / 2);\n        bottomY = randomBottomY + (bottomPipeRender.sprite.height / 2);\n        if (topY < 0 || bottomY > 0) {\n            spacing = Math.abs(topY) - Math.abs(bottomY);\n        }\n        else {\n            spacing = Math.abs(topY) + Math.abs(bottomY);\n        }\n    }\n    topPipe.parent = this.entity;\n    topPipe.transform.x = 0;\n    topPipe.transform.y = randomTopY;\n    topPipe.transform.scaleY = 1;\n    topPipe.name = 'topPipe';\n\n    bottomPipe.parent = this.entity;\n    bottomPipe.transform.x = 0;\n    bottomPipe.transform.y = randomBottomY;\n    bottomPipe.transform.scaleY = -1;\n    bottomPipe.name = 'bottomPipe';\n\n    this.pipeGroupWith = bottomPipeRender.sprite.width;\n};\n\nPipeGroup.prototype.onRefresh = function (gameSpeed) {\n    this.entity.transform.x -= Fire.Time.deltaTime * ( this.speed_ + gameSpeed );\n    if (this.entity.transform.x < this.range_) {\n        this.entity.destroy();\n        this.entity.dispatchEvent(new Fire.Event(\"destroy-PipeGroup\", true));\n    }\n};\n\nmodule.exports = PipeGroup;\n\nFire._RFpop();\n},{}],\"Sheep\":[function(require,module,exports){\nFire._RFpush(module, '06633wKqTVM6a1K+G262q1Q', 'Sheep');\n// script/Sheep.js\n\nvar Effect = require('Effect');\n\nvar SheepState = (function (t) {\n    t[t.none = 0] = 'none',\n    t[t.run = 0] = 'run';\n    t[t.jump = 1] = 'jump';\n    t[t.drop = 2] = 'drop';\n    t[t.down = 3] = 'down';\n    t[t.die = 4] = 'die'\n    return t;\n})({});\n\nvar Sheep = Fire.extend(Fire.Component, function () {\n    this.skyMaxY = 250;//160;\n    this.anim = null;\n    this.sheepSpritRender = 0;\n    this.runAnimState = null;\n    this.jumpAnimState = null;\n    this.dropAnimState = null;\n    this.downAnimState = null;\n    this.dieAnimState = null;\n    this.sheepState = SheepState.run;\n    this.tempSpeed = 0;\n});\n\nSheep.SheepState = SheepState;\n\nSheep.prop('gravity', 9.8);\n\nSheep.prop('speed', 300);\n\nSheep.prop('fLoorCoordinates', -180);\n\nSheep.prototype.onLoad = function () {\n    this.anim = this.entity.getComponent(Fire.SpriteAnimation);\n    this.runAnimState = this.anim.getAnimState('sheep_run');\n    this.jumpAnimState = this.anim.getAnimState('sheep_jump');\n    this.dropAnimState = this.anim.getAnimState('sheep_drop');\n    this.downAnimState = this.anim.getAnimState('sheep_down');\n    this.dieAnimState = this.anim.getAnimState('sheep_die');\n\n    this.sheepSpritRender = this.entity.getComponent(Fire.SpriteRenderer);\n    this.dieRotation = -88;\n\n    this.fogDownEffect = Fire.Entity.find('/Prefabs/fog_2');\n};\n\nSheep.prototype.init = function (pos) {\n    this.entity.transform.rotation = 0;\n    this.entity.transform.position = pos;\n    this.anim.play(this.runAnimState, 0);\n    this.sheepState = SheepState.run;\n};\n\nSheep.prototype.onRefresh = function () {\n\n    if (this.sheepState !== SheepState.run) {\n        this.tempSpeed -= (Fire.Time.deltaTime * 100) * this.gravity;\n    }\n\n    switch (this.sheepState) {\n        case SheepState.run:\n            break;\n        case SheepState.jump:\n            this.entity.transform.y += Fire.Time.deltaTime * this.tempSpeed;\n            if (this.tempSpeed < 0) {\n                this.anim.play(this.dropAnimState, 0);\n                this.sheepState = SheepState.drop;\n            }\n            break;\n        case SheepState.drop:\n            this.entity.transform.y += Fire.Time.deltaTime * this.tempSpeed;\n            if (this.entity.transform.y <= this.fLoorCoordinates) {\n                this.entity.transform.y = this.fLoorCoordinates;\n\n                var pos = new Vec2(this.entity.transform.x, this.entity.transform.y - 30);\n                Effect.create(this.fogDownEffect, pos);\n\n                this.anim.play(this.downAnimState, 0);\n                this.sheepState = SheepState.down;\n            }\n            break;\n        case SheepState.down:\n            if (this.downAnimState && !this.anim.isPlaying(this.downAnimState.name)) {\n                this.anim.play(this.runAnimState, 0);\n                this.sheepState = SheepState.run;\n            }\n            break;\n        case SheepState.die:\n            if (this.entity.transform.y > this.fLoorCoordinates) {\n                this.entity.transform.y += Fire.Time.deltaTime * this.tempSpeed;\n            }\n            else{\n                var pos = new Vec2(this.entity.transform.x, this.entity.transform.y - 30);\n                Effect.create(this.fogDownEffect, pos);\n                this.sheepState = SheepState.none;\n            }\n            break;\n        default:\n            break;\n    }\n};\n\nmodule.exports = Sheep;\n\nFire._RFpop();\n},{\"Effect\":\"Effect\"}],\"audio-clip\":[function(require,module,exports){\nFire._RFpush(module, 'audio-clip');\n// src/audio-clip.js\n\nFire.AudioClip = (function () {\n    var AudioClip = Fire.extend(\"Fire.AudioClip\", Fire.Asset);\n\n    AudioClip.prop('rawData', null, Fire.RawType('audio'), Fire.HideInInspector);\n\n    AudioClip.get('buffer', function () {\n        return Fire.AudioContext.getClipBuffer(this);\n    }, Fire.HideInInspector);\n\n    AudioClip.get(\"length\", function () {\n        return Fire.AudioContext.getClipLength(this);\n    });\n\n    AudioClip.get(\"samples\", function () {\n        return Fire.AudioContext.getClipSamples(this);\n    });\n\n    AudioClip.get(\"channels\", function () {\n        return Fire.AudioContext.getClipChannels(this);\n    });\n\n    AudioClip.get(\"frequency\", function () {\n        return Fire.AudioContext.getClipFrequency(this);\n    });\n\n    return AudioClip;\n})();\n\n// create entity action\n// @if EDITOR\nFire.AudioClip.prototype.createEntity = function ( cb ) {\n    var ent = new Fire.Entity(this.name);\n\n    var audioSource = ent.addComponent(Fire.AudioSource);\n\n    audioSource.clip = this;\n\n    if ( cb )\n        cb (ent);\n};\n// @endif\n\nmodule.exports = Fire.AudioClip;\n\nFire._RFpop();\n},{}],\"audio-legacy\":[function(require,module,exports){\nFire._RFpush(module, 'audio-legacy');\n// src/audio-legacy.js\n\n(function(){\n    var UseWebAudio = (window.AudioContext || window.webkitAudioContext || window.mozAudioContext);\n    if (UseWebAudio) {\n        return;\n    }\n    var AudioContext = {};\n\n    function loader (url, callback, onProgress) {\n        var audio = document.createElement(\"audio\");\n        audio.addEventListener(\"canplaythrough\", function () {\n            callback(null, audio);\n        }, false);\n        audio.addEventListener('error', function (e) {\n            callback('LoadAudioClip: \"' + url +\n                    '\" seems to be unreachable or the file is empty. InnerMessage: ' + e + '\\n This may caused by fireball-x/dev#267', null);\n        }, false);\n\n        audio.src = url;\n    }\n\n    Fire.LoadManager.registerRawTypes('audio', loader);\n\n    AudioContext.initSource = function (target) {\n        target._audio = null;\n    };\n\n    AudioContext.getCurrentTime = function (target) {\n        if (target && target._audio && target._playing) {\n            return target._audio.currentTime;\n        }\n        else {\n            return 0;\n        }\n    };\n\n    AudioContext.updateTime = function (target, value) {\n        if (target && target._audio) {\n            var duration = target._audio.duration;\n            target._audio.currentTime = value;\n        }\n    };\n\n    // 靜音\n    AudioContext.updateMute = function (target) {\n        if (!target || !target._audio) { return; }\n        target._audio.muted = target.mute;\n    };\n\n    // 设置音量，音量范围是[0, 1]\n    AudioContext.updateVolume = function (target) {\n        if (!target || !target._audio) { return; }\n        target._audio.volume = target.volume;\n    };\n\n    // 设置循环\n    AudioContext.updateLoop = function (target) {\n        if (!target || !target._audio) { return; }\n        target._audio.loop = target.loop;\n    };\n\n    // 将音乐源节点绑定具体的音频buffer\n    AudioContext.updateAudioClip = function (target) {\n        if (!target || !target.clip) { return; }\n        target._audio = target.clip.rawData;\n    };\n\n    // 暫停\n    AudioContext.pause = function (target) {\n        if (!target._audio) { return; }\n        target._audio.pause();\n    };\n\n    // 停止\n    AudioContext.stop = function (target) {\n        if (!target._audio) { return; }\n        target._audio.pause();\n        target._audio.currentTime = 0;\n    };\n\n    // 播放\n    AudioContext.play = function (target) {\n        if (!target || !target.clip || !target.clip.rawData) { return; }\n        if (target._playing && !target._paused) { return; }\n        this.updateAudioClip(target);\n        this.updateVolume(target);\n        this.updateLoop(target);\n        this.updateMute(target);\n        target._audio.play();\n\n        // 播放结束后的回调\n        target._audio.addEventListener('ended', function () {\n            target.onPlayEnd.bind(target);\n        }, false);\n    };\n\n    // 获得音频剪辑的 buffer\n    AudioContext.getClipBuffer = function (clip) {\n        Fire.error(\"Audio does not contain the <Buffer> attribute!\");\n        return null;\n    };\n\n    // 以秒为单位 获取音频剪辑的 长度\n    AudioContext.getClipLength = function (clip) {\n        return clip.rawData.duration;\n    };\n\n    // 音频剪辑的长度\n    AudioContext.getClipSamples = function (target) {\n        Fire.error(\"Audio does not contain the <Samples> attribute!\");\n        return null;\n    };\n\n    // 音频剪辑的声道数\n    AudioContext.getClipChannels = function (target) {\n        Fire.error(\"Audio does not contain the <Channels> attribute!\");\n        return null;\n    };\n\n    // 音频剪辑的采样频率\n    AudioContext.getClipFrequency = function (target) {\n        Fire.error(\"Audio does not contain the <Frequency> attribute!\");\n        return null;\n    };\n\n\n    Fire.AudioContext = AudioContext;\n})();\n\nFire._RFpop();\n},{}],\"audio-source\":[function(require,module,exports){\nFire._RFpush(module, 'audio-source');\n// src/audio-source.js\n\nvar AudioSource = (function () {\n    var AudioSource = Fire.extend(\"Fire.AudioSource\", Fire.Component, function () {\n        this._playing = false; //-- 声源暂停或者停止时候为false\n        this._paused = false;//-- 来区分声源是暂停还是停止\n\n        this._startTime = 0;\n        this._lastPlay = 0;\n\n        this._buffSource = null;\n        this._volumeGain = null;\n\n        this.onEnd = null;\n    });\n\n    //\n    Fire.addComponentMenu(AudioSource, 'AudioSource');\n\n    //\n    Object.defineProperty(AudioSource.prototype, \"isPlaying\", {\n        get: function () {\n            return this._playing && !this._paused;\n        }\n    });\n\n    Object.defineProperty(AudioSource.prototype, \"isPaused\", {\n        get: function () {\n            return this._paused;\n        }\n    });\n\n    //\n    Object.defineProperty(AudioSource.prototype, 'time', {\n        get: function () {\n            return Fire.AudioContext.getCurrentTime(this);\n        },\n        set: function (value) {\n            Fire.AudioContext.updateTime(this, value);\n        }\n    });\n\n    //\n    AudioSource.prop('_playbackRate', 1.0, Fire.HideInInspector);\n    AudioSource.getset('playbackRate',\n        function () {\n            return this._playbackRate;\n        },\n        function (value) {\n            if (this._playbackRate !== value) {\n                this._playbackRate = value;\n                Fire.AudioContext.updatePlaybackRate(this);\n            }\n        }\n    );\n\n    //\n    AudioSource.prop('_clip', null, Fire.HideInInspector);\n    AudioSource.getset('clip',\n        function () {\n            return this._clip;\n        },\n        function (value) {\n            if (this._clip !== value) {\n                this._clip = value;\n                Fire.AudioContext.updateAudioClip(this);\n            }\n        },\n        Fire.ObjectType(Fire.AudioClip)\n    );\n\n    //\n    AudioSource.prop('_loop', false, Fire.HideInInspector);\n    AudioSource.getset('loop',\n       function () {\n           return this._loop;\n       },\n       function (value) {\n           if (this._loop !== value) {\n               this._loop = value;\n               Fire.AudioContext.updateLoop(this);\n           }\n       }\n    );\n\n    //\n    AudioSource.prop('_mute', false, Fire.HideInInspector);\n    AudioSource.getset('mute',\n       function () {\n           return this._mute;\n       },\n       function (value) {\n           if (this._mute !== value) {\n               this._mute = value;\n               Fire.AudioContext.updateMute(this);\n           }\n       }\n    );\n\n    //\n    AudioSource.prop('_volume', 1, Fire.HideInInspector);\n    AudioSource.getset('volume',\n       function () {\n           return this._volume;\n       },\n       function (value) {\n           if (this._volume !== value) {\n               this._volume = Math.clamp01(value);\n               Fire.AudioContext.updateVolume(this);\n           }\n       },\n       Fire.Range(0,1)\n    );\n\n    AudioSource.prop('playOnAwake', true);\n\n    AudioSource.prototype.onPlayEnd = function () {\n        if ( this.onEnd ) {\n            this.onEnd();\n        }\n\n        this._playing = false;\n        this._paused = false;\n    };\n\n    AudioSource.prototype.pause = function () {\n        if ( this._paused )\n            return;\n\n        Fire.AudioContext.pause(this);\n        this._paused = true;\n    };\n\n    AudioSource.prototype.play = function () {\n        if ( this._playing && !this._paused )\n            return;\n\n        if ( this._paused )\n            Fire.AudioContext.play(this, this._startTime);\n        else\n            Fire.AudioContext.play(this, 0);\n\n        this._playing = true;\n        this._paused = false;\n    };\n\n    AudioSource.prototype.stop = function () {\n        if ( !this._playing ) {\n            return;\n        }\n\n        Fire.AudioContext.stop(this);\n        this._playing = false;\n        this._paused = false;\n    };\n\n    AudioSource.prototype.onLoad = function () {\n        if (this._playing ) {\n            this.stop();\n        }\n    };\n\n    AudioSource.prototype.onStart = function () {\n        //if (this.playOnAwake) {\n        //    console.log(\"onStart\");\n        //    this.play();\n        //}\n    };\n\n    AudioSource.prototype.onEnable = function () {\n        if (this.playOnAwake) {\n            this.play();\n        }\n    };\n\n    AudioSource.prototype.onDisable = function () {\n        this.stop();\n    };\n\n    return AudioSource;\n})();\n\nFire.AudioSource = AudioSource;\n\nFire._RFpop();\n},{}],\"audio-web-audio\":[function(require,module,exports){\nFire._RFpush(module, 'audio-web-audio');\n// src/audio-web-audio.js\n\n(function () {\n    var NativeAudioContext = (window.AudioContext || window.webkitAudioContext || window.mozAudioContext);\n    if ( !NativeAudioContext ) {\n        return;\n    }\n\n    // fix fireball-x/dev#365\n    if (!Fire.nativeAC) {\n        Fire.nativeAC = new NativeAudioContext();\n    }\n\n    // 添加safeDecodeAudioData的原因：https://github.com/fireball-x/dev/issues/318\n    function safeDecodeAudioData(context, buffer, url, callback) {\n        var timeout = false;\n        var timerId = setTimeout(function () {\n            callback('The operation of decoding audio data already timeout! Audio url: \"' + url +\n                     '\". Set Fire.AudioContext.MaxDecodeTime to a larger value if this error often occur. ' +\n                     'See fireball-x/dev#318 for details.', null);\n        }, AudioContext.MaxDecodeTime);\n\n        context.decodeAudioData(buffer,\n            function (decodedData) {\n                if (!timeout) {\n                    callback(null, decodedData);\n                    clearTimeout(timerId);\n                }\n            },\n            function (e) {\n                if (!timeout) {\n                    callback(null, 'LoadAudioClip: \"' + url +\n                        '\" seems to be unreachable or the file is empty. InnerMessage: ' + e);\n                    clearTimeout(timerId);\n                }\n            }\n        );\n    }\n\n    function loader(url, callback, onProgress) {\n        var cb = callback && function (error, xhr) {\n            if (xhr) {\n                safeDecodeAudioData(Fire.nativeAC, xhr.response, url, callback);\n            }\n            else {\n                callback('LoadAudioClip: \"' + url +\n               '\" seems to be unreachable or the file is empty. InnerMessage: ' + error, null);\n            }\n        };\n        Fire.LoadManager._loadFromXHR(url, cb, onProgress, 'arraybuffer');\n    }\n\n    Fire.LoadManager.registerRawTypes('audio', loader);\n\n    var AudioContext = {};\n\n    AudioContext.MaxDecodeTime = 4000;\n\n    AudioContext.getCurrentTime = function (target) {\n        if ( target._paused ) {\n            return target._startTime;\n        }\n\n        if ( target._playing ) {\n            return target._startTime + this.getPlayedTime(target);\n        }\n\n        return 0;\n    };\n\n    AudioContext.getPlayedTime = function (target) {\n        return (Fire.nativeAC.currentTime - target._lastPlay) * target._playbackRate;\n    };\n\n    //\n    AudioContext.updateTime = function (target, time) {\n        target._lastPlay = Fire.nativeAC.currentTime;\n        target._startTime = time;\n\n        if ( target.isPlaying ) {\n            this.pause(target);\n            this.play(target);\n        }\n    };\n\n    //\n    AudioContext.updateMute = function (target) {\n        if (!target._volumeGain) { return; }\n        target._volumeGain.gain.value = target.mute ? -1 : (target.volume - 1);\n    };\n\n    // range [0,1]\n    AudioContext.updateVolume = function (target) {\n        if (!target._volumeGain) { return; }\n        target._volumeGain.gain.value = target.volume - 1;\n    };\n\n    //\n    AudioContext.updateLoop = function (target) {\n        if (!target._buffSource) { return; }\n        target._buffSource.loop = target.loop;\n    };\n\n    // bind buffer source\n    AudioContext.updateAudioClip = function (target) {\n        if ( target.isPlaying ) {\n            this.stop(target,false);\n            this.play(target);\n        }\n    };\n\n    //\n    AudioContext.updatePlaybackRate = function (target) {\n        if ( !this.isPaused ) {\n            this.pause(target);\n            this.play(target);\n        }\n    };\n\n    //\n    AudioContext.pause = function (target) {\n        if (!target._buffSource) { return; }\n\n        target._startTime += this.getPlayedTime(target);\n        target._buffSource.onended = null;\n        target._buffSource.stop(0);\n    };\n\n    //\n    AudioContext.stop = function ( target, ended ) {\n        if (!target._buffSource) { return; }\n\n        if ( !ended ) {\n            target._buffSource.onended = null;\n        }\n        target._buffSource.stop(0);\n    };\n\n    //\n    AudioContext.play = function ( target, at ) {\n        if (!target.clip || !target.clip.rawData) { return; }\n\n        // create buffer source\n        var bufferSource = Fire.nativeAC.createBufferSource();\n\n        // create volume control\n        var gain = Fire.nativeAC.createGain();\n\n        // connect\n        bufferSource.connect(gain);\n        gain.connect(Fire.nativeAC.destination);\n        bufferSource.connect(Fire.nativeAC.destination);\n\n        // init parameters\n        bufferSource.buffer = target.clip.rawData;\n        bufferSource.loop = target.loop;\n        bufferSource.playbackRate.value = target.playbackRate;\n        bufferSource.onended = target.onPlayEnd.bind(target);\n        gain.gain.value = target.mute ? -1 : (target.volume - 1);\n\n        //\n        target._buffSource = bufferSource;\n        target._volumeGain = gain;\n        target._startTime = at || 0;\n        target._lastPlay = Fire.nativeAC.currentTime;\n\n        // play\n        bufferSource.start( 0, this.getCurrentTime(target) );\n    };\n\n    // ===================\n\n    //\n    AudioContext.getClipBuffer = function (clip) {\n        return clip.rawData;\n    };\n\n    //\n    AudioContext.getClipLength = function (clip) {\n        if (clip.rawData) {\n            return clip.rawData.duration;\n        }\n        return -1;\n    };\n\n    //\n    AudioContext.getClipSamples = function (clip) {\n        if (clip.rawData) {\n            return clip.rawData.length;\n        }\n        return -1;\n    };\n\n    //\n    AudioContext.getClipChannels = function (clip) {\n        if (clip.rawData) {\n            return clip.rawData.numberOfChannels;\n        }\n        return -1;\n    };\n\n    //\n    AudioContext.getClipFrequency = function (clip) {\n        if (clip.rawData) {\n            return clip.rawData.sampleRate;\n        }\n        return -1;\n    };\n\n\n    Fire.AudioContext = AudioContext;\n})();\n\nFire._RFpop();\n},{}],\"sprite-animation-clip\":[function(require,module,exports){\nFire._RFpush(module, 'sprite-animation-clip');\n// sprite-animation-clip.js\n\n// 动画剪辑\n\nvar SpriteAnimationClip = Fire.extend('Fire.SpriteAnimationClip', Fire.CustomAsset, function () {\n    this._frameInfoFrames = null; // the array of the end frame of each frame info\n});\n\nFire.addCustomAssetMenu(SpriteAnimationClip, \"New Sprite Animation\");\n\nSpriteAnimationClip.WrapMode = Fire.defineEnum({\n    Default: -1,\n    Once: -1,\n    Loop: -1,\n    PingPong: -1,\n    ClampForever: -1\n});\n\nSpriteAnimationClip.StopAction = Fire.defineEnum({\n    DoNothing: -1,    // do nothing\n    DefaultSprite: 1, // set to default sprite when the sprite animation stopped\n    Hide: -1,         // hide the sprite when the sprite animation stopped\n    Destroy: -1       // destroy the entity the sprite belongs to when the sprite animation stopped\n});\n\n// ------------------------------------------------------------------\n/// The structure to descrip a frame in the sprite animation clip\n// ------------------------------------------------------------------\n\nvar FrameInfo = Fire.define('FrameInfo')\n                    .prop('sprite', null, Fire.ObjectType(Fire.Sprite))\n                    .prop('frames', 0, Fire.Integer);\n\n///< the list of frame info\n// to do\n\n// default wrap mode\nSpriteAnimationClip.prop('wrapMode', SpriteAnimationClip.WrapMode.Default, Fire.Enum(SpriteAnimationClip.WrapMode));\n\n// the default type of action used when the animation stopped\nSpriteAnimationClip.prop('stopAction', SpriteAnimationClip.StopAction.DoNothing, Fire.Enum(SpriteAnimationClip.StopAction));\n\n// the default speed of the animation clip\nSpriteAnimationClip.prop('speed', 1);\n\n// the sample rate used in this animation clip\nSpriteAnimationClip.prop('_frameRate', 60, Fire.HideInInspector);\nSpriteAnimationClip.getset('frameRate',\n    function () {\n        return this._frameRate;\n    },\n    function (value) {\n        if (value !== this._frameRate) {\n            this._frameRate = Math.round(Math.max(value, 1));\n        }\n    }\n);\n\nSpriteAnimationClip.prop('frameInfos', [], Fire.ObjectType(FrameInfo));\n\n\nSpriteAnimationClip.prototype.getTotalFrames = function () {\n    var frames = 0;\n    for (var i = 0; i < this.frameInfos.length; ++i) {\n        frames += this.frameInfos[i].frames;\n    }\n    return frames;\n};\n\nSpriteAnimationClip.prototype.getFrameInfoFrames = function () {\n    if (this._frameInfoFrames === null) {\n        this._frameInfoFrames = new Array(this.frameInfos.length);\n        var totalFrames = 0;\n        for (var i = 0; i < this.frameInfos.length; ++i) {\n            totalFrames += this.frameInfos[i].frames;\n            this._frameInfoFrames[i] = totalFrames;\n        }\n    }\n    return this._frameInfoFrames;\n};\n\nFire.SpriteAnimationClip = SpriteAnimationClip;\n\nmodule.exports = SpriteAnimationClip;\n\nFire._RFpop();\n},{}],\"sprite-animation-state\":[function(require,module,exports){\nFire._RFpush(module, 'sprite-animation-state');\n// sprite-animation-state.js\n\nvar SpriteAnimationClip = require('sprite-animation-clip');\n\nvar SpriteAnimationState = function (animClip) {\n    if (!animClip) {\n// @if DEV\n        Fire.error('Unspecified sprite animation clip');\n// @endif\n        return;\n    }\n    // the name of the sprite animation state\n    this.name = animClip.name;\n    // the referenced sprite sprite animation clip\n    this.clip = animClip;\n    // the wrap mode\n    this.wrapMode = animClip.wrapMode;\n    // the stop action\n    this.stopAction = animClip.stopAction;\n    // the speed to play the sprite animation clip\n    this.speed = animClip.speed;\n    // the array of the end frame of each frame info in the sprite animation clip\n    this._frameInfoFrames = animClip.getFrameInfoFrames();\n    // the total frame count of the sprite animation clip\n    this.totalFrames = this._frameInfoFrames.length > 0 ? this._frameInfoFrames[this._frameInfoFrames.length - 1] : 0;\n    // the length of the sprite animation in seconds with speed = 1.0f\n    this.length = this.totalFrames / animClip.frameRate;\n    // The current index of frame. The value can be larger than totalFrames.\n    // If the frame is larger than totalFrames it will be wrapped according to wrapMode. \n    this.frame = -1;\n    // the current time in seoncds\n    this.time = 0;\n    // cache result of GetCurrentIndex\n    this._cachedIndex = -1;\n};\n\n/**\n * @returns {number} - the current frame info index.\n */\nSpriteAnimationState.prototype.getCurrentIndex = function () {\n    if (this.totalFrames > 1) {\n        //int oldFrame = frame;\n        this.frame = Math.floor(this.time * this.clip.frameRate);\n        if (this.frame < 0) {\n            this.frame = -this.frame;\n        }\n\n        var wrappedIndex;\n        if (this.wrapMode !== SpriteAnimationClip.WrapMode.PingPong) {\n            wrappedIndex = _wrap(this.frame, this.totalFrames - 1, this.wrapMode);\n        }\n        else {\n            wrappedIndex = this.frame;\n            var cnt = Math.floor(wrappedIndex / this.totalFrames);\n            wrappedIndex %= this.totalFrames;\n            if ((cnt & 0x1) === 1) {\n                wrappedIndex = this.totalFrames - 1 - wrappedIndex;\n            }\n        }\n\n        // try to use cached frame info index\n        if (this._cachedIndex - 1 >= 0 &&\n            wrappedIndex >= this._frameInfoFrames[this._cachedIndex - 1] &&\n            wrappedIndex < this._frameInfoFrames[this._cachedIndex]) {\n            return this._cachedIndex;\n        }\n\n        // search frame info\n        var frameInfoIndex = _binarySearch(this._frameInfoFrames, wrappedIndex + 1);\n        if (frameInfoIndex < 0) {\n            frameInfoIndex = ~frameInfoIndex;\n        }\n        this._cachedIndex = frameInfoIndex;\n        return frameInfoIndex;\n    }\n    else if (this.totalFrames === 1) {\n        return 0;\n    }\n    else {\n        return -1;\n    }\n};\n\n// ------------------------------------------------------------------ \n/// C# Array.BinarySearch\n// ------------------------------------------------------------------ \nfunction _binarySearch (array, value) {\n    var l = 0, h = array.length - 1;\n    while (l <= h) {\n        var m = ((l + h) >> 1);\n        if (array[m] === value) {\n            return m;\n        }\n        if (array[m] > value) {\n            h = m - 1;\n        }\n        else {\n            l = m + 1;\n        }\n    }\n    return ~l;\n}\n\nfunction _wrap (_value, _maxValue, _wrapMode) {\n    if (_maxValue === 0) {\n        return 0;\n    }\n    if (_value < 0) {\n        _value = -_value;\n    }\n    if (_wrapMode === SpriteAnimationClip.WrapMode.Loop) {\n        return _value % (_maxValue + 1);\n    }\n    else if (_wrapMode === SpriteAnimationClip.WrapMode.PingPong) {\n        var cnt = Math.floor(_value / _maxValue);\n        _value %= _maxValue;\n        if (cnt % 2 === 1) {\n            return _maxValue - _value;\n        }\n    }\n    else {\n        if (_value < 0) {\n            return 0;\n        }\n        if (_value > _maxValue) {\n            return _maxValue;\n        }\n    }\n    return _value;\n}\n\nFire.SpriteAnimationState = SpriteAnimationState;\n\nmodule.exports = SpriteAnimationState;\n\nFire._RFpop();\n},{\"sprite-animation-clip\":\"sprite-animation-clip\"}],\"sprite-animation\":[function(require,module,exports){\nFire._RFpush(module, 'sprite-animation');\n// sprite-animation.js\n\nvar SpriteAnimationClip = require('sprite-animation-clip');\nvar SpriteAnimationState = require('sprite-animation-state');\n\n// 定义一个名叫Sprite Animation 组件\nvar SpriteAnimation = Fire.extend('Fire.SpriteAnimation', Fire.Component, function () {\n    this.animations = [];\n    this._nameToState = null;\n    this._curAnimation = null;\n    this._spriteRenderer = null;\n    this._defaultSprite = null;\n    this._lastFrameIndex = -1;\n    this._curIndex = -1;\n    this._playStartFrame = 0;// 在调用Play的当帧的LateUpdate不进行step\n});\n\nFire.addComponentMenu(SpriteAnimation, 'Sprite Animation');\n\nSpriteAnimation.prop('defaultAnimation', null, Fire.ObjectType(SpriteAnimationClip));\n\nSpriteAnimation.prop('animations', [], Fire.ObjectType(SpriteAnimationClip));\n\nSpriteAnimation.prop('_playAutomatically', true, Fire.HideInInspector);\nSpriteAnimation.getset('playAutomatically',\n    function () {\n        return this._playAutomatically;\n    },\n    function (value) {\n        this._playAutomatically = value;\n    }\n);\n\nSpriteAnimation.prototype.init = function () {\n    var initialized = (this._nameToState !== null);\n    if (initialized === false) {\n        this._spriteRenderer = this.entity.getComponent(Fire.SpriteRenderer);\n        this._defaultSprite = this._spriteRenderer.sprite;\n\n        this._nameToState = {};\n        var state = null;\n        for (var i = 0; i < this.animations.length; ++i) {\n            var clip = this.animations[i];\n            if (clip !== null) {\n                state = new SpriteAnimationState(clip);\n                this._nameToState[state.name] = state;\n            }\n        }\n\n        if (!this.getAnimState(this.defaultAnimation.name)) {\n            state = new SpriteAnimationState(this.defaultAnimation);\n            this._nameToState[state.name] = state;\n        }\n    }\n};\n\nSpriteAnimation.prototype.getAnimState = function (name) {\n    return this._nameToState && this._nameToState[name];\n};\n\n/**\n * indicates whether the animation is playing\n * @param {string} [animName] - The name of the animation\n */\nSpriteAnimation.prototype.isPlaying = function (name) {\n    var playingAnim = this.enabled && this._curAnimation;\n    return !!playingAnim && ( !name || playingAnim.name === name );\n};\n\n/**\n * play Animation\n * @param {SpriteAnimationState} [animState|animName] - The animState of the SpriteAnimationState\n * @param {SpriteAnimationState} [animState] - The time of the animation time\n */\nSpriteAnimation.prototype.play = function (animState, time) {\n    if (typeof animState === 'string') {\n        this._curAnimation = this.getAnimState(animState);\n    }\n    else {\n        this._curAnimation = animState || new SpriteAnimationState(this.defaultAnimation);\n    }\n\n    if (this._curAnimation !== null) {\n        this._curIndex = -1;\n        this._curAnimation.time = time || 0;\n        this._playStartFrame = Fire.Time.frameCount;\n        this.sample();\n    }\n};\n\nSpriteAnimation.prototype.onLoad = function () {\n    this.init();\n    if (this.enabled) {\n        if (this._playAutomatically && this.defaultAnimation) {\n            var animState = this.getAnimState(this.defaultAnimation.name);\n            this.play(animState, 0);\n        }\n    }\n};\n\nSpriteAnimation.prototype.lateUpdate = function () {\n    if (this._curAnimation !== null && Fire.Time.frameCount > this._playStartFrame) {\n        var delta = Fire.Time.deltaTime * this._curAnimation.speed;\n        this.step(delta);\n    }\n};\n\nSpriteAnimation.prototype.step = function (deltaTime) {\n    if (this._curAnimation !== null) {\n        this._curAnimation.time += deltaTime;\n        this.sample();\n        var stop = false;\n        if (this._curAnimation.wrapMode === SpriteAnimationClip.WrapMode.Once ||\n            this._curAnimation.wrapMode === SpriteAnimationClip.WrapMode.Default ||\n            this._curAnimation.wrapMode === SpriteAnimationClip.WrapMode.ClampForever) {\n            if (this._curAnimation.speed > 0 && this._curAnimation.frame >= this._curAnimation.totalFrames) {\n                if (this._curAnimation.wrapMode === SpriteAnimationClip.WrapMode.ClampForever) {\n                    stop = false;\n                    this._curAnimation.frame = this._curAnimation.totalFrames;\n                    this._curAnimation.time = this._curAnimation.frame / this._curAnimation.clip.frameRate;\n                }\n                else {\n                    stop = true;\n                    this._curAnimation.frame = this._curAnimation.totalFrames;\n                }\n            }\n            else if (this._curAnimation.speed < 0 && this._curAnimation.frame < 0) {\n                if (this._curAnimation.wrapMode === SpriteAnimationClip.WrapMode.ClampForever) {\n                    stop = false;\n                    this._curAnimation.time = 0;\n                    this._curAnimation.frame = 0;\n                }\n                else {\n                    stop = true;\n                    this._curAnimation.frame = 0;\n                }\n            }\n        }\n\n        // do stop\n        if (stop) {\n            this.stop(this._curAnimation);\n        }\n    }\n    else {\n        this._curIndex = -1;\n    }\n};\n\nSpriteAnimation.prototype.sample = function () {\n    if (this._curAnimation !== null) {\n        var newIndex = this._curAnimation.getCurrentIndex();\n        if (newIndex >= 0 && newIndex != this._curIndex) {\n            this._spriteRenderer.sprite = this._curAnimation.clip.frameInfos[newIndex].sprite;\n        }\n        this._curIndex = newIndex;\n    }\n    else {\n        this._curIndex = -1;\n    }\n};\n\nSpriteAnimation.prototype.stop = function (animState) {\n    if (animState !== null) {\n        if (animState === this._curAnimation) {\n            this._curAnimation = null;\n        }\n        animState.time = 0;\n\n        var stopAction = animState.stopAction;\n        switch (stopAction) {\n            case SpriteAnimationClip.StopAction.DoNothing:\n                break;\n            case SpriteAnimationClip.StopAction.DefaultSprite:\n                this._spriteRenderer.sprite = this._defaultSprite;\n                break;\n            case SpriteAnimationClip.StopAction.Hide:\n                this._spriteRenderer.enabled = false;\n                break;\n            case SpriteAnimationClip.StopAction.Destroy:\n\n                this.entity.destroy();\n                break;\n            default:\n                break;\n        }\n        this._curAnimation = null;\n    }\n};\n\nFire.SpriteAnimation = SpriteAnimation;\n\nmodule.exports = SpriteAnimation;\n\nFire._RFpop();\n},{\"sprite-animation-clip\":\"sprite-animation-clip\",\"sprite-animation-state\":\"sprite-animation-state\"}]},{},[\"audio-clip\",\"audio-legacy\",\"audio-source\",\"audio-web-audio\",\"sprite-animation-clip\",\"sprite-animation-state\",\"sprite-animation\",\"AudioControl\",\"Collision\",\"Effect\",\"Floor\",\"Game\",\"GameOverWindow\",\"MainMenu\",\"PipeGroup\",\"Sheep\"]);\n"],"sourceRoot":"/source/"}